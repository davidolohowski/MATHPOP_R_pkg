# simulate point pattern from Sersic profile
simulate_Sersic <- function(N, c, R_eff, e, n, theta){
  bn <- zipfR::Rgamma.inv(2*n, 0.5)
  z <- runif(N)
  x <- zipfR::Rgamma.inv(2*n, z)
  R <- (x/bn)^n*R_eff
  t <- runif(N, 0, 2*pi)
  A <- matrix(c(cos(theta), sin(theta), -sin(theta), cos(theta)),2,2)
  X <- solve(A, t(cbind(R*cos(t), R*sin(t)*e)))
  return(data.frame(x = c[1] + X[1,], y = c[2] + X[2,]))
}
